<!DOCTYPE html>
<html lang="en">
<head>
    <script src="js/jquerymin.js"></script>
    <meta charset="UTF-8">
    <title>Questions</title>
    <style>
        .button{
  display:inline-block;
  text-decoration:none;
  color:yellow;
  font-weight:bold;
  min-width:132px;
  min-height:37px;
  border:1px solid black;
  border-radius:12px;
  text-align:center;
  background-color:gray;
  box-shadow:8px 8px 8px gray;
  margin:10px;
  position:fixed;
  top:500px;
  left:800px;
  }

  .button1{
  display:inline-block;
  text-decoration:none;
  color:yellow;
  font-weight:bold;
  min-width:132px;
  min-height:37px;
  border:1px solid black;
  border-radius:12px;
  text-align:center;
  background-color:gray;
  box-shadow:8px 8px 8px gray;
  margin:10px;
  position:fixed;
  top:500px;
  left:650px;
  }

  .button2{
  display:inline-block;
  text-decoration:none;
  color:yellow;
  font-weight:bold;
  min-width:132px;
  min-height:37px;
  border:1px solid black;
  border-radius:12px;
  text-align:center;
  background-color:gray;
  box-shadow:8px 8px 8px gray;
  margin:10px;
  position:fixed;
  top:500px;
  left:950px;
  }

  .button3{
  display:inline-block;
  text-decoration:none;
  color:yellow;
  font-weight:bold;
  min-width:132px;
  min-height:37px;
  border:1px solid black;
  border-radius:12px;
  text-align:center;
  background-color:gray;
  box-shadow:8px 8px 8px gray;
  margin:10px;
  position:fixed;
  top:500px;
  left:1100px;
  }

.button:active{
  background-color:blue;
  position:fixed;
  top:508px;
  left:808px;
}

.button1:active{
  background-color:blue;
  position:fixed;
  top:508px;
  left:658px;
}

.button2:active{
  background-color:blue;
  position:fixed;
  top:508px;
  left:958px;
}

.button3:active{
  background-color:blue;
  position:fixed;
  top:508px;
  left:1108px;
}
    </style>
    <script>
    var iod=0;
        function checksessionid(){
        	var sessi = getCookie("id");
                    if(sessi.length<69){
                    	return false;
                    // disableprevious();
                    }
                    else {
                    	getquestion();
                    	return true;
                    }
        }
        function getCookie(cname) {
		    var name = cname + "=";
		    var ca = document.cookie.split(';');
		        var c = ca[i];
		        var c1 = c.split('=');
		        if(c1.length<69)
		        	return "";
		        else
		        	return c1[1];
		}

        // $(document).ready(function(){
            // $("#next").click(function(){ //////////////////////////////////////////////////
            	function getquestion(){
	            	var sessi = getCookie("id");
	            	var session = JSON.stringify({"SessionId":sessi});
	                $.get("/questions", {studentJson: session} ,function(data){
	                	var data1 = JSON.parse(result);
						localStorage.setItem("JSONQuestion", data1);
	                    // fetchquestion();
	                    // disablenext();
	                    // addquestion(data.question);
	                    // if(data.File==null){
	                        // addaudiofile(data.audio);
	                        // addchoice(data.op); //// audio or video
	                    // }
	                    // if(data.File!="no"){
	                        // addvideofile(data.video);
	                        // addchoice(data.Choice);/// array 01234
	                    // }
	                // });
	            }
            // });
        // });

        function fetchquestion(nop){
        if(nop==0){
            disableprevious();
        }
        else {
            enableprevious();
        }
        $("div").remove();
            window.iod=window.iod+nop;
        	var text, obj;
        	if(checksessionid){
        		text = localStorage.getItem("JSONQuestion");
				obj = JSON.parse(text);
				if(obj[window.iod].Question[window.iod].SubQuestion[window.iod].Question!=null){
					addquestion(obj[window.iod].Question[window.iod].SubQuestion[window.iod].Question);
				}
				if(obj[window.iod].Question[window.iod].File!=null){
					var a1=obj[window.iod].Question[window.iod].File;
					var n=a1;
					if(a1.substring(n-3, n)=="mp3"){
						//audio
						addaudiofile(a1);
					}
					else if(a1.substring(n-3, n)=="mp4"){
						//video
						addvideofile(a1);
					}
				}

				if(obj[window.iod].Question[window.iod].SubQuestion[window.iod].Choice!=null){
				    addchoice(obj[window.iod].Question[window.iod].SubQuestion[window.iod].Choice[i]);
				}
				if(obj[window.iod].Question[window.iod].SubQuestion[window.iod].Choice==null){
                    ///fill in the blank
				}
        	}
        }


        function addquestion(q){
            $("#question").load(q);
        }

        function addchoice(c){
            for(var i=0; i<obj[window.iod].Question[window.iod].SubQuestion[window.iod].Choice.length;i++){
                $('#option').append('<input id="choice"' + i + ' type="radio" name="" onclick="enablenext();savedata(i)"/><br>');
                $("#choice"+i).load(c[0]);
            }
        }

        function addaudiofile(a){
            $('#audio').append('<audio id="audiofile" controls/>');
            $('#audiofile').append('<source src=' + a + ' type="audio/ogg" />');
        }

        function addvideofile(v){
            $('#video').append('<video id="videofile" width="400" controls/>');
            $('#videofile').append('<source src=' + v + ' type="video/mp4"/>');
        }

        function disablenext(){
            $('#next').attr('disabled','disabled');
        }

        function enablenext(){
            $('#next').removeAttr('disabled');
        }

        function disableprevious(){
            $('#previous').attr('disabled','disabled');
        }

        function enableprevious(){
            $('#previous').removeAttr('disabled');
        }

        function disablesave(){
            $('#save').attr('disabled','disabled');
        }

        function enablesave(){
            $('#save').removeAttr('disabled');
        }

        function disablesubmit(){
            $('#submit').attr('disabled','disabled');
        }

        function enablesubmit(){
            $('#submit').removeAttr('disabled');
        }

        function datasend(){
            var json = JSON.stringify({"QuestionId":window.iod,"Answer":document.getElementById()});
                $.get("/questions", {updateJson:json} ,function(data){
                    //store data in local storage
                    <!--window.location = "/result";-->
                });
        }

        function savedata(i1){
            var json = JSON.stringify({"QuestionId":window.iod,"Answer":document.getElementById(i1).});
                $.get("/questions", {updateJson:json} ,function(data){
                    //store data in local storage
                    <!--window.location = "/result";-->
                });
        }

    </script>
</head>
<body onload="fetchquestion(0)">
<div id="question">
    Questions dispalyed here
</div>
<div id="audio"></div>
<div id="video">
    <video id="videofile" width="400" controls/>
    <source src="a.mp4" type="video/mp4"/>
    </video>
</div>
<div id="option">
    options
</div>
<button class="button" id="next" onclick="fetchquestion(1)">Next</button>
<button class="button1" id="previous" onclick="fetchquestion(-1)">Previous</button>
<button class="button2" id="save" onclick="datasend()">Save</button>
<button class="button3" id="submit" onclick="done()">Submit</button>
</body>
</html>